<div class="row center-align">
  <div class="col right">
    <!-- Modal Trigger -->
    <a class="waves-effect waves-light btn-floating btn-large modal-trigger green right" href="#modal-project-new">
      <i class="material-icons">add</i>
    </a>
    <!-- -->
  </div>
  <div class="center-align">
    <h3>Projetos</h3>
  </div>
</div>

<!-- Modal Structure -->
<% @project = Project.new %>
<div id="modal-project-new" class="modal black-text">
  <div class="modal-content">
    <h4>Criar projeto</h4>
    <%= render 'projects/form' %>
  </div>
</div>
<!-- End Modal -->

<div class="row">
  <% @projects.each do |p| %>
    <div class="col s12 m12 l4">
      <div class="card">
        <div class="card-image waves-effect waves-block waves-light">
          <img class="activator" src="<%=p.image.url%>">
        </div>
        <div class="card-content">
          <span class="card-title activator grey-text text-darken-4"><%=p.name%><i class="material-icons right">more_vert</i></span>
          <p>
            <%= link_to p, class: 'btn-floating btn-large waves-effect waves-light blue' do %>
              <i class="material-icons">dashboard</i>
            <% end %>
            <!-- Modal Trigger -->
            <a class="waves-effect waves-light btn-floating btn-large modal-trigger blue" href="#modal-project-edit-<%= p.id %>">
              <i class="material-icons">description</i>
            </a>
            <!--  -->
            <%= link_to p, method: :delete, data: { confirm: 'Tem certeza que deseja excluir este projeto?' }, class: 'btn-floating btn-large waves-effect waves-light red right' do %>
              <i class="material-icons">delete</i>
            <% end %>
            <!-- Modal Structure -->
            <% @project = p %>
            <div id="modal-project-edit-<%= p.id %>" class="modal black-text">
              <div class="modal-content">
                <h4>Editar projeto: <%= p.name %></h4>
                <%= render 'projects/form' %>
              </div>
            </div>
            <!-- End Modal -->
          </p>
        </div>
        <div class="card-reveal">
          <span class="card-title grey-text text-darken-4"><%=p.name%><i class="material-icons right">close</i></span>
          <table>
            <thead>
              <tr>
                <th>Descrição</th>
                <th>Data de inicial</th>
                <th>Data final</th>
                <th>Progresso</th>
                <th colspan="3"></th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><%= p.description %></td>
                <td><%= p.start_date %></td>
                <td><%= p.end_date %></td>
                <td><%= p.progress %></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  <% end %>
</div>
